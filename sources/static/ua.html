<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8">
  <title>播放视频</title>
  <link href="lib/bootstrap.min.css" rel="stylesheet">
  <link href="css/x100speed.css" rel="stylesheet">
</head>
<body>

<div class="container">
<nav class="navbar navbar-default navbar-fixed-top" style="border-top:2px solid #f06923;">
  <div class="container">
    <div class="navbar-header">
      <a class="navbar-brand" style="color: #333; text-shadow: 0 1px 3px rgba(0,0,0,.5);" href="/"><em>x100Speed-Transcode</em></a>
    </div>
    <div id="navbar" class="navbar-collapse navbar-right">
      <a class="navbar-brand" href="http://10.221.193.64:8080/upload.html" style="font-size: 16px">上传视频</a>
      <a class="navbar-brand" href="play.html" style="color: #f06923;font-size: 16px">播放视频</a>
    </div>
  </div>
</nav>
</div>

<div class="container" style="margin-top: 200px;">
  <div id="web" style="display:none">
    <div class="row">
      <div class="col-md-8 col-md-offset-2">
        <h1>播放视频</h1>
        <form class="form-inline" id="upload-form" action="">
          <input id="play_url" type="text" class="form-control input-lg" size="48" placeholder="输入m3u8地址" autofocus />
          <input type="button" class="btn btn-default btn-lg" id="play" value="播放" />
        </form>
      </div> <!-- col-md-8 col-md-offset-2 -->
    </div> <!-- row -->
            
    <div class="container" style="margin-top: 10px;">
      <div class="row">
        <div class="col-md-10 col-md-offset-1">
          <canvas id="player_canvas" width="640" height="360" style="background-color: #000;"></canvas>
        </div> <!-- col-md-10 col-md-offset-1 -->
      </div> <!-- row -->
    </div> <!-- container -->
  </div> <!-- web -->
</div> <!-- container -- >

<div id="mobile" style="display:none">
    <div class="row">
      <div class="col-md-8 col-md-offset-2">
        <h1>播放视频</h1>
			<video id="video_play" controls >
			</video>
      </div> <!-- col-md-8 col-md-offset-2 -->
    </div> <!-- row -->
</div>

</body>
</html>

<script src="lib/jquery-1.11.3.min.js"></script>
<script src="lib/x100toolkit.js"></script>
<script type="text/javascript">
function play_m3u8(m3u8_url) {
  $("#play_url").val(m3u8_url);
  $("#player_js").attr( { "src": "lib/hls/browser.js", "data-canvas": "player_canvas", "data-hls": m3u8_url} );
}
 
$("#play").click( function () {
  var m3u8_url = $("#play_url").val();
  play_m3u8(m3u8_url);
});

$(document).ready(function(){
  alert(navigator.userAgent.toLowerCase());
  var play_url = getUrlParameter('play_url');
  if (navigator.userAgent.match(/Mobi/)) {
      // mobile!
	$('#mobile').show();
	$('#video_play').attr('src', play_url);
  	$('#video_play')[0].play();
  }
  else {
	alert("in web");
	$('#web').show();
	if (play_url.substr(0, 7) == "http://" && play_url.substr(-4, 4) == "m3u8" ) {
  	  play_m3u8(play_url);
  	}
  }
});
</script>

<!-- below script tag MUST be the last script tag !!! -->
<script id="player_js"></script>
